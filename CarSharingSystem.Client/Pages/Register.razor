@page "/register"
@inject HttpClient Http
@inject NavigationManager Nav

<h3>📝 Rejestracja nowego użytkownika</h3>

@if (!string.IsNullOrEmpty(message))
{
    <div>@message</div>
}

<div class="form-group">
    <input @bind="name" placeholder="Imię i nazwisko" class="form-control" />
    <input @bind="email" placeholder="Email" class="form-control mt-2" />
    <input type="password" @bind="password" placeholder="Hasło" class="form-control mt-2" />
    <button @onclick="RegisterUser" class="btn btn-success mt-3">Zarejestruj</button>
</div>

@code {
    private string name = "";
    private string email = "";
    private string password = "";
    private string message = "";

    private async Task RegisterUser()
    {
        var res = await Http.PostAsJsonAsync("users/register", new { name, email, password });

        if (res.IsSuccessStatusCode)
        {
            message = "✅ Rejestracja udana! Możesz się teraz zalogować.";
            await Task.Delay(1500);
            Nav.NavigateTo("/login");
        }
        else
        {
            message = "❌ Błąd podczas rejestracji. Spróbuj ponownie.";
        }
    }
}
